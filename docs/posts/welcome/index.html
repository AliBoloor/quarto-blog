<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.33">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Ali Boloor">
<meta name="dcterms.date" content="2026-01-15">

<title>Welcome To My Blog – quarto blog</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-ea385d0e468b0dd5ea5bf0780b1290d9.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-c1fac2584b48ed01fb6e278e36375074.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">quarto blog</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com"> <i class="bi bi-twitter" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Welcome To My Blog</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">news</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Ali Boloor </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">January 15, 2026</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<section id="historical-vs-implied-volatility" class="level1">
<h1><strong>Historical vs Implied Volatility</strong></h1>
<section id="motivation-and-background" class="level2">
<h2 class="anchored" data-anchor-id="motivation-and-background"><strong>Motivation and Background</strong></h2>
<p>If you spend your evenings following the markets, you quickly notice that prices do not move smoothly. Some nights are calm, like a quiet campus after midnight. Other nights are hectic, with news, surprises, and sharp moves. In finance, we use the word <strong>volatility</strong> to describe how rough or calm that ride is.</p>
<p>For someone like Rivaldo, who enjoys making small profits in the stock market and later spending them on a good bottle of wine, volatility is not an abstract academic idea. It directly affects how risky a trade feels, how much you can gain or lose, and how stressful the experience can be. Understanding volatility helps you decide when to be cautious and when opportunity may be worth the risk.</p>
<p>This post explains two common ways of thinking about volatility: one that looks backward at what has already happened, and one that looks forward using information embedded in option prices. These are known as <strong>historical volatility</strong> and <strong>implied volatility</strong>.</p>
<hr>
</section>
<section id="what-volatility-represents-in-financial-markets" class="level2">
<h2 class="anchored" data-anchor-id="what-volatility-represents-in-financial-markets"><strong>What Volatility Represents in Financial Markets</strong></h2>
<p>Volatility measures how much prices fluctuate over time. A stock that moves up or down by small amounts every day has low volatility. A stock that regularly jumps or crashes has high volatility.</p>
<p>Volatility is not about direction. A stock can go up a lot and still be volatile, or go down a lot and be volatile. What matters is the size and unpredictability of the moves.</p>
<hr>
</section>
<section id="why-volatility-matters" class="level2">
<h2 class="anchored" data-anchor-id="why-volatility-matters"><strong>Why Volatility Matters</strong></h2>
<p>Volatility plays a central role in finance for three main reasons.</p>
<p>First, it matters for <strong>pricing</strong>. Many financial instruments, especially options, depend directly on volatility. Higher volatility usually means higher option prices.</p>
<p>Second, it matters for <strong>risk management</strong>. Volatility tells you how uncertain your outcomes are. Higher volatility means a wider range of possible gains and losses.</p>
<p>Third, it matters for <strong>trading</strong>. Some strategies work best in calm markets, others in turbulent ones. Knowing the volatility regime helps align strategy with market conditions.</p>
<hr>
</section>
<section id="two-perspectives-on-volatility" class="level2">
<h2 class="anchored" data-anchor-id="two-perspectives-on-volatility"><strong>Two Perspectives on Volatility</strong></h2>
<p>There are two main ways to think about volatility.</p>
<ul>
<li><p>A <strong>backward-looking</strong> view, which measures how much prices moved in the past.</p></li>
<li><p>A <strong>forward-looking</strong> view, which uses market prices to infer expectations about future movement.</p></li>
</ul>
<p>These correspond to historical volatility and implied volatility.</p>
<hr>
</section>
<section id="historical-volatility" class="level2">
<h2 class="anchored" data-anchor-id="historical-volatility"><strong>Historical Volatility</strong></h2>
<section id="definition-and-intuition" class="level3">
<h3 class="anchored" data-anchor-id="definition-and-intuition"><strong>Definition and Intuition</strong></h3>
<p>Historical volatility measures how much a stock’s price has fluctuated in the past. It is based entirely on realized returns that have already occurred.</p>
<p>Intuitively, it answers the question: <em>How bumpy has the road been recently?</em></p>
</section>
<section id="how-it-is-computed" class="level3">
<h3 class="anchored" data-anchor-id="how-it-is-computed"><strong>How It Is Computed</strong></h3>
<p>The standard approach is to take past returns, compute their standard deviation, and scale it to an annual number.</p>
<p>Here is a simple example using daily returns.</p>
<div id="56844487" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate daily returns</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">0</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>returns <span class="op">=</span> np.random.normal(<span class="dv">0</span>, <span class="fl">0.01</span>, <span class="dv">252</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># rolling 20-day historical volatility</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>hv_20 <span class="op">=</span> pd.Series(returns).rolling(<span class="dv">20</span>).std() <span class="op">*</span> np.sqrt(<span class="dv">252</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>plt.plot(hv_20)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"20-Day Historical Volatility"</span>)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Annualized Volatility"</span>)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-2-output-1.png" width="597" height="431" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="common-choices-and-assumptions" class="level3">
<h3 class="anchored" data-anchor-id="common-choices-and-assumptions"><strong>Common Choices and Assumptions</strong></h3>
<p>Several choices go into this calculation.</p>
<ul>
<li><p><strong>Rolling windows</strong>: 10 days, 20 days, 60 days, or longer.</p></li>
<li><p><strong>Sampling frequency</strong>: daily, weekly, or even intraday returns.</p></li>
<li><p><strong>Stationarity assumption</strong>: past volatility is assumed to be informative about the near future.</p></li>
</ul>
<p>Different choices can produce noticeably different numbers.</p>
</section>
<section id="strengths-and-limitations" class="level3">
<h3 class="anchored" data-anchor-id="strengths-and-limitations"><strong>Strengths and Limitations</strong></h3>
<p>Historical volatility is simple and transparent. Anyone can compute it, and there are no hidden assumptions beyond basic statistics.</p>
<p>However, it adapts slowly. If market conditions suddenly change, historical volatility only updates as new data comes in. By the time it reflects a new regime, the most important moves may already be over.</p>
<hr>
</section>
</section>
<section id="implied-volatility" class="level2">
<h2 class="anchored" data-anchor-id="implied-volatility"><strong>Implied Volatility</strong></h2>
<section id="definition-and-intuition-1" class="level3">
<h3 class="anchored" data-anchor-id="definition-and-intuition-1"><strong>Definition and Intuition</strong></h3>
<p>Implied volatility comes from option prices. Instead of looking at past returns, it asks: <em>What level of volatility makes observed option prices make sense under a pricing model?</em></p>
<p>In practice, it is the volatility number that traders back out from option prices.</p>
</section>
<section id="how-it-is-extracted-from-option-prices" class="level3">
<h3 class="anchored" data-anchor-id="how-it-is-extracted-from-option-prices"><strong>How It Is Extracted from Option Prices</strong></h3>
<p>Option pricing models relate option prices to inputs such as stock price, interest rates, time to maturity, and volatility. All inputs except volatility are directly observable. Volatility is inferred as the value that matches the market price.</p>
</section>
<section id="why-it-is-often-called-market-expectations" class="level3">
<h3 class="anchored" data-anchor-id="why-it-is-often-called-market-expectations"><strong>Why It Is Often Called “Market Expectations”</strong></h3>
<p>Implied volatility reflects what option buyers and sellers are willing to pay for protection or leverage. Because options are forward-looking contracts, implied volatility is commonly interpreted as the market’s view of future uncertainty.</p>
<p>This interpretation is useful, but not perfect, as we will see.</p>
</section>
<section id="key-properties" class="level3">
<h3 class="anchored" data-anchor-id="key-properties"><strong>Key Properties</strong></h3>
<p>Implied volatility has several important features.</p>
<ul>
<li><p>It depends on <strong>strike price and maturity</strong>. There is not just one implied volatility, but an entire surface.</p></li>
<li><p>It reflects <strong>risk premia</strong>. Investors often pay extra to insure against bad outcomes.</p></li>
<li><p>It is influenced by <strong>supply and demand</strong>, not just pure expectations.</p></li>
</ul>
<hr>
</section>
</section>
<section id="comparing-historical-and-implied-volatility" class="level2">
<h2 class="anchored" data-anchor-id="comparing-historical-and-implied-volatility"><strong>Comparing Historical and Implied Volatility</strong></h2>
<section id="empirical-relationship" class="level3">
<h3 class="anchored" data-anchor-id="empirical-relationship"><strong>Empirical Relationship</strong></h3>
<p>When plotted together, historical and implied volatility often move in the same direction, but implied volatility usually sits above historical volatility.</p>
<div id="627269a0" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># mock comparison</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>plt.plot(hv_20, label<span class="op">=</span><span class="st">"Historical Volatility"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>plt.axhline(hv_20.mean() <span class="op">*</span> <span class="fl">1.2</span>, linestyle<span class="op">=</span><span class="st">"--"</span>, label<span class="op">=</span><span class="st">"Implied Volatility (stylized)"</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Historical vs Implied Volatility"</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-3-output-1.png" width="579" height="431" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="typical-patterns" class="level3">
<h3 class="anchored" data-anchor-id="typical-patterns"><strong>Typical Patterns</strong></h3>
<p>Two patterns appear frequently.</p>
<ul>
<li><p>Implied volatility tends to exceed historical volatility on average.</p></li>
<li><p>The gap widens during periods of uncertainty.</p></li>
</ul>
</section>
<section id="when-they-diverge-most" class="level3">
<h3 class="anchored" data-anchor-id="when-they-diverge-most"><strong>When They Diverge Most</strong></h3>
<p>The difference between the two measures often grows around major events.</p>
<ul>
<li><p><strong>Earnings announcements</strong>, when surprise risk is high.</p></li>
<li><p><strong>Market stress</strong>, such as financial crises or sudden macroeconomic shocks.</p></li>
</ul>
</section>
<section id="what-information-each-measure-contains" class="level3">
<h3 class="anchored" data-anchor-id="what-information-each-measure-contains"><strong>What Information Each Measure Contains</strong></h3>
<p>Historical volatility summarizes what has happened. Implied volatility combines expectations, fear, and compensation for risk. They answer related but different questions.</p>
<hr>
</section>
</section>
<section id="what-does-the-market-know" class="level2">
<h2 class="anchored" data-anchor-id="what-does-the-market-know"><strong>What Does the Market “Know”?</strong></h2>
<section id="predicting-future-volatility" class="level3">
<h3 class="anchored" data-anchor-id="predicting-future-volatility"><strong>Predicting Future Volatility</strong></h3>
<p>A natural question is whether implied volatility predicts future realized volatility better than historical measures.</p>
<p>Empirical studies generally find that implied volatility contains useful information about future volatility, but it is not an unbiased forecast.</p>
</section>
<section id="interpretation" class="level3">
<h3 class="anchored" data-anchor-id="interpretation"><strong>Interpretation</strong></h3>
<p>The key distinction is between <strong>risk-neutral</strong> and <strong>real-world</strong> expectations.</p>
<p>Implied volatility reflects prices under a risk-neutral framework, where investors demand compensation for bearing volatility risk. This extra compensation is known as the <strong>volatility risk premium</strong>.</p>
<p>As a result, implied volatility tends to be higher than what is eventually realized.</p>
<hr>
</section>
</section>
<section id="data-science-perspective" class="level2">
<h2 class="anchored" data-anchor-id="data-science-perspective"><strong>Data Science Perspective</strong></h2>
<section id="framing-as-a-prediction-problem" class="level3">
<h3 class="anchored" data-anchor-id="framing-as-a-prediction-problem"><strong>Framing as a Prediction Problem</strong></h3>
<p>From a data science point of view, comparing historical and implied volatility becomes a forecasting task. The goal is to predict future realized volatility using available information.</p>
<p>Inputs might include:</p>
<ul>
<li><p>Past realized volatility</p></li>
<li><p>Implied volatility levels</p></li>
<li><p>Features derived from volatility surfaces</p></li>
<li><p>Market indicators and macro variables</p></li>
</ul>
</section>
<section id="evaluation-challenges" class="level3">
<h3 class="anchored" data-anchor-id="evaluation-challenges"><strong>Evaluation Challenges</strong></h3>
<p>This problem has several difficulties.</p>
<ul>
<li><p>Realized volatility is noisy.</p></li>
<li><p>Forecast horizons matter greatly.</p></li>
<li><p>Structural breaks and regime changes limit model stability.</p></li>
</ul>
<p>Purely predictive models often struggle without strong domain knowledge.</p>
<hr>
</section>
</section>
<section id="practical-implications" class="level2">
<h2 class="anchored" data-anchor-id="practical-implications"><strong>Practical Implications</strong></h2>
<section id="for-traders" class="level3">
<h3 class="anchored" data-anchor-id="for-traders"><strong>For Traders</strong></h3>
<p>If implied volatility is much higher than historical volatility, some traders sell volatility, collecting premium while betting on calm conditions. Others buy volatility when they expect turbulence.</p>
</section>
<section id="for-risk-managers" class="level3">
<h3 class="anchored" data-anchor-id="for-risk-managers"><strong>For Risk Managers</strong></h3>
<p>Implied volatility is useful for stress testing. It reveals how the market prices extreme scenarios, even if they have not occurred recently.</p>
</section>
<section id="for-modelers" class="level3">
<h3 class="anchored" data-anchor-id="for-modelers"><strong>For Modelers</strong></h3>
<p>Historical data alone can be misleading during regime changes. Market-implied information provides a complementary signal when past data is sparse or uninformative.</p>
<hr>
</section>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion"><strong>Conclusion</strong></h2>
<p>Historical and implied volatility offer two different lenses on market uncertainty.</p>
<p>Historical volatility is simple, transparent, and grounded in realized data. Implied volatility is forward-looking, richer, and shaped by risk preferences and market structure.</p>
<p>Neither measure is “right” on its own. The most useful insights come from combining both. Historical data anchors us in reality, while implied volatility reveals how the market is pricing the unknown.</p>
<p>For someone trading modestly and thoughtfully, understanding both perspectives can mean steadier decisions, fewer surprises, and hopefully a better glass of wine at the end of the week.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>